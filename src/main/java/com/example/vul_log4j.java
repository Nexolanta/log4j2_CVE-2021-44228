package com.example;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import com.sun.net.httpserver.HttpExchange;
import com.sun.net.httpserver.HttpHandler;
import com.sun.net.httpserver.HttpServer;

import java.io.IOException;
import java.io.OutputStream;
import java.net.InetSocketAddress;

public class vul_log4j {

    private static final Logger logger = LogManager.getLogger(LogManager.ROOT_LOGGER_NAME);
    public static void main(String[] args) throws IOException {


        HttpServer server = HttpServer.create(new InetSocketAddress(8006), 0);
        server.createContext("/test", new TestHandler());
        server.start();
            }

            static  class TestHandler implements HttpHandler{
                @Override
                public void handle(HttpExchange exchange) throws IOException {
                    String user_agent = exchange.getRequestHeaders().getFirst("user-agent");
                    logger.error(user_agent);
                    String response = "hello world";
                    exchange.sendResponseHeaders(200, 0);
                    OutputStream os = exchange.getResponseBody();
                    os.write(response.getBytes());
                    os.close();
                }
            }

}
